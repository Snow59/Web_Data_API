import requests

from flask import Flask, render_template, request, jsonify
from pymongo import MongoClient
from bson.objectid import ObjectId

app = Flask(__name__)
client = MongoClient("mongodb://localhost:27017/")
MONGO_URI = "mongodb://localhost:27017/"
DB_NAME = "Hamza"
COLLECTION_NAME = "infos"

def abd():
        json_data = {
            'username': 'admin',
            'password': 'secret',
        }

        response = requests.post('http://localhost:8000/login',json=json_data)
        print(response.json())




def test():
        # Connexion à MongoDB (assurez-vous que MongoDB est accessible à cette adresse)
        #client = MongoClient("mongodb://localhost:27017/")

        # Création ou sélection de la base de données
        #db = client["Hamza"]

        # Création ou sélection de la collection
        #collection = db["Infos"]

        # Insertion de données initiales dans la collection
        # data_initiale = {"nom": "sri-rame", "valeur": 15555}
        # resultat = collection.insert_one(data_initiale)
        #
        # print(resultat)

        # for document in collection.find():
        #     print(document)
        #     # Vérifiez si l'_id du document correspond à l'_id que vous voulez supprimer
        #     if str(document.get("_id")) == "65c4dc8f4e817c7d9c9fcac6":
        #         # Suppression du document
        #         collection.delete_one({"_id": ObjectId("65c4dc8f4e817c7d9c9fcac6")})
        #         print("Document supprimé")

        #print(f"Document inséré avec l'ID: {resultat.inserted_id}")

        import requests

        headers = {
            # Already added when you pass json=
            # 'Content-Type': 'application/json',
        }

        json_data = {
            'nom': 'exempleNom',
            'valeur': 12345,
        }

        response = requests.post('http://localhost:2000/byID', headers=headers, json=json_data)
        print(response.json())


def addjson():
    from pymongo import MongoClient
    import json

    file_path = 'users.json'

    # Connexion à MongoDB
    client = MongoClient("mongodb://localhost:27017/")
    db = client["Hamza"]
    collection = db["infos"]

    # Lire le fichier JSON
    with open(file_path, 'r') as file:
        file_data = json.load(file)


    if isinstance(file_data, list):
        collection.insert_many(file_data)
    else:
        collection.insert_one(file_data)

    print("Les données ont été insérées dans MongoDB.")



def affichage():
    # Connexion au client MongoDB
    client = MongoClient("mongodb://localhost:27017/")
    db = client["Hamza"]
    collection = db["infos"]

    # Récupération et affichage de tous les documents de la collection
    documents = collection.find()
    for document in documents:
        print(document)




def login():



    headers = {
        'accept': 'application/json',
        'Content-Type': 'application/json',
    }

    json_data = {
        'user': 'NICOLE',
        'password': 'mdp2',
    }

    response = requests.post('http://localhost:8000/login', headers=headers, json=json_data)
    print(response.json())


def create_account():
    headers = {
        'accept': 'application/json',
        'Content-Type': 'application/json',
    }

    json_data = {
        'user': 'NICOLE',
        'password': 'mdp2',
    }

    response = requests.post('http://localhost:8000/create', headers=headers, json=json_data)
    print(response.json())

def checktoken():

    headers = {
        'Authorization': 'Bearer Mettre_ici_le_token_que_login_retourne_dans_la_console',
    }


    response = requests.get('http://localhost:8000/check_token', headers=headers)
    print(response.content)
    print(response.status_code)


create_account()
#login()
#affichage()
#addjson()
#checktoken()
#get_by_id()
